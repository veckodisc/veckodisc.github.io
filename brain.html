<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>The second brain</title>
		<style>
		    body{
		        background:#000;
		        padding:0px;
		        margin:0px;
		    }
		</style>
		 <script src="js/rectangle.js"></script> 
	</head>
	<body>

		<form id="form-id" action="/brick" method="post" >
	  		<input type="hidden" id="postId" name="cube_nr"/>
		</form>

		<script type="module">
			class Rectangle {
			  constructor(obj) {
				this.height = obj.height;
				this.width = obj.width;
			  }
			  calcArea() {
				return this.height * this.width;
			  }
			}
			console.log(Date.now().toString(36) + Math.floor(Math.pow(10, 12) + Math.random() * 9*Math.pow(10, 12)).toString(36));
			let rect = new Rectangle({"height": 10, "width": 20});
			console.log(rect);
			console.log(rect.calcArea());
		
			localStorage.setItem("lastname", "Smith");
			console.log(localStorage.getItem("lastname"));
			
    		let response = await fetch('https://veckodisc.github.io/json/data.json');
			let json = await response.json();
    		console.log(json.title);
    		
    		var testObject = { 'one': 1, 'two': 2, 'three': 3 };

			// Put the object into storage
			localStorage.setItem('testObject', JSON.stringify(rect));

			// Retrieve the object from storage
			var retrievedObject = localStorage.getItem('testObject');
			let obj = JSON.parse(retrievedObject);
			
			let rect2 = new Rectangle(obj);
			console.log(rect2.calcArea());

			console.log('retrievedObject: ', JSON.parse(retrievedObject));
		    import * as THREE from 'https://cdn.skypack.dev/three@0.136.0/build/three.module.js';
		    import { OrbitControls } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls.js';
		    import { GLTFLoader } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/GLTFLoader.js';
		    import { FontLoader } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/loaders/FontLoader.js';
		    import { TextGeometry } from 'https://cdn.skypack.dev/three@0.136.0/examples/jsm/geometries/TextGeometry.js';
		    
		    const scene = new THREE.Scene();
		    const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
		    const renderer = new THREE.WebGLRenderer( { antialias: true } );
		    const geometry = new THREE.BoxGeometry();
		    const material = new THREE.MeshPhongMaterial( { color: 0x00ff00 } );
		    const materialC = new THREE.MeshPhongMaterial( { color: 0x00ff00 } );
		    const cubeA = new THREE.Mesh( geometry, material );
		    const cubeB = new THREE.Mesh( geometry, material );
		    const cubeC = new THREE.Mesh( geometry, materialC );
		    cubeA.position.set( -1.2, 0, 0 );
		    cubeB.position.set( 0, 0, 0 );
		    cubeC.position.set( 1.2, 0, 0 );
		    
		    cubeC.material.transparent = true;
		    cubeC.material.opacity = 0.5; 
		    
		    const controls = new OrbitControls( camera, renderer.domElement );
		    const gltfLoader = new GLTFLoader();
		    
		    const color = 0xFFFFFF;
		    const intensity = 1;
		    const light = new THREE.DirectionalLight(color, intensity);
		    light.position.set(-1, 2, 4);
		    scene.add(light);	
		    scene.add( new THREE.AmbientLight( 0xffffff, 0.4 ) );
			
		    scene.add( cubeA );
		    scene.add( cubeB );
		    scene.add( cubeC );
		    
		    let raycaster = new THREE.Raycaster();
		    let mouse = new THREE.Vector2();
		    renderer.setPixelRatio(window.devicePixelRatio);
		    cubeA.userData = {
                id: "0"
            };
            cubeB.userData = {
                id: "1"
            };
            cubeC.userData = {
                id: "2"
            };
		    var objects = [];
		    objects.push(cubeA);
		    objects.push(cubeB);
		    objects.push(cubeC);
		    
		    renderer.setSize( window.innerWidth, window.innerHeight );
		    camera.position.z = 5;
		    document.body.appendChild( renderer.domElement );
		    
		    document.addEventListener( 'mousemove', onDocumentMouseMove );
			window.addEventListener( 'resize', onWindowResize );
		    
		    document.addEventListener( 'dblclick', onDocumentDoubleClicked, false );
		    
		    
		    function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function onDocumentMouseMove( event ) {
				event.preventDefault();
				mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
			}
			
			function onDocumentDoubleClicked(event) {
    			event.preventDefault();
    			raycaster.setFromCamera( mouse, camera );
				var intersects = raycaster.intersectObjects( objects );
    			if (intersects.length > 0) {
        			//document.getElementById("postId").value = intersects[0].object.userData.id;
        			//document.getElementById("form-id").submit();
        			console.log(intersects[0].object.userData.id);
        			localStorage.setItem('current_cube', intersects[0].object.userData.id);
        			//window.location.href = "https://veckodisc.github.io/brick.html";
        			window.location.href = "brick.html";
    			}
			}

		    function animate() {
		        requestAnimationFrame( animate );
		        renderer.render( scene, camera );
		    }
		    animate();

		</script>
	</body>
</html>
